(function(c){Drupal.behaviors.sr16splashsiteESU={defaults:{siteESUClass:"form.cr-marketing-prefs-promo-form",errorMessageClass:"messages--error",errorClass:"error",previousStep:null,currentStep:"step1",hasError:!1,formSteps:{step1:"cr-marketing-prefs-promo-form-general",step2:"cr-marketing-prefs-promo-form-teacher",step3:"cr-marketing-prefs-promo-form-complete"},$errorMessages:null,errorTextMessage:"",$siteESUBlock:null},attach:function(a,b,d){b=Drupal.behaviors.sr16splashsiteESU;c(b.defaults.siteESUClass,
a).once("sr16splashsiteESU",b.setupESU);Drupal.settings.sr16splashsiteESU&&b.processContext(a)},setupESU:function(a){Drupal.settings.sr16splashsiteESU=c.extend({},Drupal.behaviors.sr16splashsiteESU.defaults);var b=Drupal.settings.sr16splashsiteESU;b.$siteESUBlock=c(b.siteESUClass,a)},processContext:function(a){a=c(a);var b=Drupal.behaviors.sr16splashsiteESU,d=Drupal.settings.sr16splashsiteESU;d.hasError=!1;if(a.hasClass(b.defaults.errorMessageClass))a.once("siteESU",b.handleErrors);if(a.hasClass(b.defaults.formSteps.step2)||a.hasClass(b.defaults.formSteps.step3)||
d.hasError)a.once("steps",b.handleSteps)},handleSteps:function(){var a=Drupal.behaviors.sr16splashsiteESU,b=Drupal.settings.sr16splashsiteESU;a.setActiveStep.call(this);(null!==b.previousStep&&b.previousStep!==b.currentStep||b.hasError)&&a.trackESU()},handleErrors:function(){var a=Drupal.settings.sr16splashsiteESU;if(c(this).parents(a.siteESUClass).length){a.$errorMessages=c(this);var b=c('input[type="submit"]',a.siteESUClass);a.hasError=a.$errorMessages.text();a.hasError=a.hasError.replace("Error message","");
a.$errorMessages.insertAfter(b.parent()).addClass("messages-cross")}},setActiveStep:function(){var a=Drupal.settings.sr16splashsiteESU,b="",d;for(d in a.formSteps)b=a.formSteps[d],c(this).hasClass(b)&&(a.previousStep=a.currentStep,a.currentStep=d)},trackESU:function(){if(dataLayer){var a=Drupal.settings.sr16splashsiteESU,b={event:"sr16splash.esu",activeStep:String(a.currentStep),previousStep:String(a.previousStep)};a.hasError&&(b.error=String(a.hasError));dataLayer.push(b)}}}})(jQuery);